(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[1],{

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _tungli_wasm_f5170_magnetic_mirror_ex1__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @tungli/wasm-f5170_magnetic_mirror_ex1 */ \"./node_modules/@tungli/wasm-f5170_magnetic_mirror_ex1/wasm_magnetic_mirror.js\");\n\n\nvar config = _tungli_wasm_f5170_magnetic_mirror_ex1__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].empty();\n\nconfig.b0 =               parseFloat(document.getElementById(\"B0\").value);\nconfig.l =                parseFloat(document.getElementById(\"L\").value);\nconfig.vel_perp =         parseFloat(document.getElementById(\"vel_perp\").value);\nconfig.vel_par =          parseFloat(document.getElementById(\"vel_par\").value);\nconfig.n_steps =          parseInt(document.getElementById(\"n_steps\").value);\n\ndocument.getElementById(\"B0\").addEventListener(\"change\", function () {\n    config.b0 = parseFloat(this.value);\n});\ndocument.getElementById(\"L\").addEventListener(\"change\", function () {\n    config.l = parseFloat(this.value);\n});\ndocument.getElementById(\"vel_perp\").addEventListener(\"change\", function () {\n    config.vel_perp = parseFloat(this.value);\n});\ndocument.getElementById(\"vel_par\").addEventListener(\"change\", function () {\n    config.vel_par = parseFloat(this.value);\n});\ndocument.getElementById(\"n_steps\").addEventListener(\"change\", function () {\n    config.n_steps = parseFloat(this.value);\n});\n\n\nvar part_anim_steps =  parseInt(document.getElementById(\"anim_steps\").value);\ndocument.getElementById(\"anim_steps\").addEventListener(\"change\", function () {\n    part_anim_steps = parseInt(this.value);\n});\n\n\nvar but0 = document.getElementById(\"gen_traj\");\nbut0.addEventListener(\"click\", gen_traj);\n\nvar traj_length = 0;\nvar do_anim = false;\nvar p_at_index = 0;\nvar x = [], y = [], z = [];\nvar px = [], py = [], pz = [];\nvar traj_plot = {};\n\nvar traj;\nfunction gen_traj () {\n    console.log(config);\n    traj = _tungli_wasm_f5170_magnetic_mirror_ex1__WEBPACK_IMPORTED_MODULE_0__[\"Trajectory\"].new(_tungli_wasm_f5170_magnetic_mirror_ex1__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].from_struct(config));\n    traj_length = config.n_steps;\n    \n    p_at_index = 0;\n    x = [], y = [], z =[];\n    for(var i=0; i<=config.n_steps; i++) {\n        x.push(traj.at(i).x());\n        y.push(traj.at(i).y());\n        z.push(traj.at(i).z());\n    }\n    \n    traj_plot = {\n        type: 'scatter3d',\n        x: x,\n        y: y,\n        z: z,\n        mode: 'lines',\n        opacity: 0.7,\n        line: {\n           width: 2,\n           color: 4,\n           colorscale: 'Turbo'\n        }\n    };\n    \n    px = [x[0]], py = [y[0]], pz = [z[0]];\n    var particle = {\n        type: 'scatter3d',\n        x: px,\n        y: py,\n        z: pz,\n    };\n    \n    Plotly.newPlot('plot3d', [traj_plot, particle], {showlegend: false});\n    do_anim = false;\n}\n\nfunction update () {\n    px[0] = x[p_at_index];\n    py[0] = y[p_at_index];\n    pz[0] = z[p_at_index];\n    \n    Plotly.animate('plot3d', {\n        data: [traj_plot, {x: px, y: py, z: pz}]\n    }, {\n        transition: {\n            duration: 0,\n        },\n        frame: {\n            duration: 0,\n            redraw: true,\n        },\n        showlegend: false\n    });\n\n    p_at_index += part_anim_steps;\n\n    if (do_anim && (p_at_index < traj_length)) {\n        let i = p_at_index;\n        document.getElementById(\"p_time\").value = traj.at(i).t;\n        document.getElementById(\"mag_moment\").value = traj.at(i).mag_moment();\n        document.getElementById(\"energy\").value = traj.at(i).energy();\n        document.getElementById(\"vperp\").value = traj.at(i).v_perp();\n        document.getElementById(\"field_mag\").value = traj.at(i).field_mag;\n        document.getElementById(\"psi\").value = Object(_tungli_wasm_f5170_magnetic_mirror_ex1__WEBPACK_IMPORTED_MODULE_0__[\"psi_1\"])(traj.at(i), _tungli_wasm_f5170_magnetic_mirror_ex1__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].from_struct(config));\n        requestAnimationFrame(update);\n    }\n    else if (p_at_index >= config.n_steps) {\n        do_anim = false;\n        p_at_index = 0;\n        px[0] = x[0], py[0] = y[0], pz[0] = z[0]; \n    }\n}\n\nvar but1 = document.getElementById(\"run_anim\");\nbut1.addEventListener(\"click\", runAnim);\n\nvar but2 = document.getElementById(\"stop_anim\");\nbut2.addEventListener(\"click\", stopAnim);\n\nfunction runAnim () {\n    if (!do_anim) {\n        do_anim = true;\n        requestAnimationFrame(update);\n    }\n}\n\nfunction stopAnim () {\n    do_anim = false;\n}\n\n\n\n//# sourceURL=webpack:///./index.js?");

/***/ })

}]);